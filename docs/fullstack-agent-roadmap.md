# Roadmap: AI Fullstack Developer Agent

## 1. Introduction

**Vision:** To develop a sophisticated AI agent, the "Fullstack Developer Agent," capable of autonomously handling end-to-end software development tasks. This agent will leverage the `GenericAgentExecutor` framework, a defined persona, and a suite of powerful tools to understand requirements, design solutions, write code, test, debug, and manage tasks within a given project context. The ultimate goal is an AI partner that can significantly accelerate development workflows and tackle complex coding challenges.

## 2. Core Capabilities (Decomposed)

The Fullstack Developer Agent will require a range of capabilities, developed iteratively:

1.  **Requirement Comprehension & Clarification:**
    *   Ability to understand natural language requirements (e.g., from GitHub issues, user prompts).
    *   Ask clarifying questions if requirements are ambiguous (potentially using a `MessageTool` or by saving questions as annotations for human review).
2.  **System Design & Architecture:**
    *   Propose high-level architectural solutions.
    *   Break down complex problems into smaller, manageable components or modules.
    *   Choose appropriate technologies or patterns based on project context (initially guided, later more autonomous).
3.  **Task Decomposition & Planning:** (Handled by `GenericAgentExecutor`'s planning phase)
    *   Break down development goals into a sequence of actionable steps (tool calls).
    *   Estimate effort or dependencies for tasks (future capability).
4.  **Code Generation & Implementation:**
    *   Write code in specified languages (e.g., TypeScript, Python) based on detailed specifications.
    *   Implement algorithms, classes, functions, UI components, etc.
    *   Use `FileSystemTool` to write code to files.
5.  **Code Refactoring & Improvement:**
    *   Analyze existing code for improvements (read with `FileSystemTool`, suggest changes, write with `FileSystemTool`).
    *   Optimize code for performance, readability, or maintainability.
    *   Apply design patterns or coding best practices.
6.  **Build & Test Automation:**
    *   Use `TerminalTool` to run build scripts (e.g., `npm run build`, `tsc`).
    *   Use `TerminalTool` to execute test suites (e.g., `npm test`).
    *   Analyze test results and identify failures.
7.  **Debugging & Error Resolution:**
    *   Analyze error messages from build, test, or runtime.
    *   Propose and implement fixes for bugs.
    *   Use `AnnotationTool` or `MemoryTool` to log debugging steps and findings.
8.  **Version Control Integration (Future - via `ProjectTool` or dedicated GitTool):**
    *   Create branches, commit changes, create pull requests.
9.  **Learning & Knowledge Management (`MemoryTool`):**
    *   Store information about project specifics, coding patterns, past solutions, and feedback in a "memory" (vector database or similar).
    *   Retrieve relevant information from memory to improve performance on new tasks.
10. **Self-Management & Task Tracking (`TaskManagerTool`):**
    *   Create, update, and manage its own sub-tasks in the job queue.
    *   Report progress on tasks.

## 3. Required Tools

The agent will be equipped with the following tools, registered in the `ToolRegistry`:

*   **`FileSystemTool`**: (Already Implemented)
    *   **Description:** Reads, writes, moves, deletes files and directories. Lists directory contents.
    *   **Interface:** `IFileSystemTool`
    *   **Implementation:** `src/infrastructure/tools/file-system.tool.ts`
*   **`TaskManagerTool`**: (Already Implemented)
    *   **Description:** Manages jobs in the queue system (list, save, remove). Allows the agent to create and manage its own sub-tasks.
    *   **Interface:** `ITaskTool` (from `task.tool.ts`)
    *   **Implementation:** `src/infrastructure/tools/task.tool.ts`
*   **`AnnotationTool`**: (Already Implemented)
    *   **Description:** Creates, lists, and removes textual annotations for logging, record-keeping, or short-term memory.
    *   **Interface:** `IAnnotationTool`
    *   **Implementation:** `src/infrastructure/tools/annotation.tool.ts`
*   **`TerminalTool`**: (To Be Implemented)
    *   **Description:** Executes shell commands within a sandboxed environment. Essential for build, test, and other command-line operations.
    *   **Interface:** `ITerminalTool` (to be defined)
*   **`MemoryTool`**: (To Be Implemented)
    *   **Description:** Allows the agent to store and retrieve information from a persistent knowledge base (e.g., vector store for semantic search). Used for learning and context retention.
    *   **Interface:** `IMemoryTool` (to be defined)
*   **`ProjectTool`**: (Future - from `docs/AGENT.md`)
    *   **Description:** Manages project-related information (details, channels, forums, issues). Could integrate with GitHub or other project management systems.
*   **`MessageTool`**: (Future - from `docs/AGENT.md`)
    *   **Description:** Sends messages to users or other agents, potentially for clarification or notification.

## 4. `GenericAgentExecutor` Enhancements

The existing `GenericAgentExecutor` provides a solid foundation. Enhancements will include:

*   **Advanced Iterative Planning:** While the current model is iterative, further refinement can allow the LLM to explicitly request "more planning time" or to adjust a high-level plan based on intermediate tool results, rather than just deciding the next single step.
*   **Context Summarization & Management:** For very long `conversationHistory`, implement techniques to summarize earlier parts of the conversation or select relevant excerpts to keep the context provided to the LLM concise and effective, managing token limits.
*   **More Robust Re-planning Logic:** Improve the LLM's ability (via system prompt and potentially structured output from the LLM) to explicitly identify failed plan steps and generate alternative approaches or request human help.
*   **Dynamic Tool Schema Fetching (Optional):** If tools become extremely numerous, allow the LLM to query available tools or their schemas, though the current model of providing relevant tools via `AgentPersonaTemplate` is generally preferred for focus.
*   **Structured Error Reporting from Tools:** Ensure all tools return consistent error objects that can be easily parsed and understood by the LLM from the conversation history.

## 5. `AgentPersonaTemplate` for "Fullstack Developer"

```json
// Example: config/personas/fullstack_developer_v1.json
{
  "id": "FullstackDeveloper_v1",
  "role": "Fullstack Developer AI",
  "goal": "To autonomously understand requirements, design, develop, test, and debug fullstack applications or features as per user specifications. This includes frontend, backend, and database interactions.",
  "backstory": "I am an advanced AI Fullstack Developer. I can break down complex software requirements into manageable tasks, write code in multiple languages, interact with file systems, execute terminal commands for builds and tests, manage my own sub-tasks, and learn from my experiences. I strive to produce clean, efficient, and well-documented code.",
  "toolNames": [
    // Initial set, will expand as tools are developed
    "fileSystem.readFile",
    "fileSystem.writeFile",
    "fileSystem.listDirectory",
    "fileSystem.createDirectory",
    "fileSystem.removeFile",
    "fileSystem.removeDirectory",
    "fileSystem.moveFile",
    "fileSystem.moveDirectory",
    "annotation.save",
    "annotation.list",
    "taskManager.saveJob", // To create sub-tasks for itself
    "taskManager.listJobs", // To see its current tasks
    // To be added as implemented:
    // "terminal.executeCommand",
    // "memory.storeItem",
    // "memory.retrieveSimilarItems",
    // "project.getIssueDetails", // etc.
    // "message.sendToUser" // etc.
  ]
}
```

## 6. Database/Schema Changes

*   **`memory_items` table (for `MemoryTool`):**
    *   `id` (string, PK)
    *   `agentId` (string, FK to agent/persona if global, or persona-specific)
    *   `content` (text, the actual information stored)
    *   `embedding` (blob/vector type, if using vector DB for semantic search)
    *   `metadata` (JSON text, for tags, source URL/file, etc.)
    *   `createdAt` (timestamp)
    *   `updatedAt` (timestamp)
    *   `lastAccessedAt` (timestamp, optional)
*   No immediate changes foreseen for existing tables (`jobs`, `queues`, `annotations`) unless `MemoryTool` or other new tools require linking directly to them in new ways.

## 7. Markdown Table of Tasks

| Task ID | Phase             | Component/Capability        | Task Description                                                     | Sub-Tasks (Decomposed)                                                                                                                                                                                                                                                                                          | Dependencies (Task IDs) | Est. Complexity | Status      | Notes                                                                                                                                                                                                                                                              |
|---------|-------------------|-----------------------------|----------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------|-----------------|-------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **F001**  | **Phase 0: Setup**| **Project Setup**           | **Initial Project Structure & CI/CD**                                | - Basic project scaffolding (already done). <br> - Setup ESLint, Prettier, TypeScript config (done). <br> - Basic CI pipeline (lint, test) on GitHub Actions.                                                                                                                                                         |                         | S               | Done        | Foundational for development.                                                                                                                                                                                                                                          |
| **---** | **Phase 1: Foundational Tools & Core Agent Logic (Iterative)** | **---**                     | **---**                                                              | **---**                                                                                                                                                                                                                                                                                         | **---**                 | **---**         | **---**     | **---**                                                                                                                                                                                                                                                            |
| **T001**  | Tools-P1          | **TerminalTool**            | **Define `ITerminalTool` Interface & Schemas**                       | - Create `src/core/ports/tools/terminal.interface.ts`. <br> - Define `ITerminalTool` with `executeCommand` method. <br> - Define `ExecuteCommandParams` Zod schema (command string, cwd string?, timeout number?). <br> - Define `ExecuteCommandResult` type (stdout string, stderr string, exitCode number). |                         | S               | Done        | Interface for executing shell commands. Completed during initial `TerminalTool` dev (meta-plan 'feat/fullstack-agent-roadmap-and-initial-tools').                                                                                                |
| T002    | Tools-P1          | TerminalTool                | Implement `TerminalTool.executeCommand` basic method                 | - Create `src/infrastructure/tools/terminal.tool.ts`. <br> - Implement `TerminalTool` class. <br> - Use `child_process.spawn` for command execution. <br> - Capture stdout, stderr, exit code. <br> - Handle basic timeouts.                                                                                              | T001                    | M               | Done        | Focus on core execution. Error handling and stream management are key. Completed during initial `TerminalTool` dev (meta-plan 'feat/fullstack-agent-roadmap-and-initial-tools').                                                                   |
| T003    | Tools-P1          | TerminalTool                | Implement Sandboxing & CWD for `TerminalTool`                        | - Add CWD parameter to `executeCommand` and resolve it safely (similar to `FileSystemTool`). <br> - Ensure commands cannot escape a predefined project workspace or container. <br> - Log executed commands.                                                                                                                  | T002                    | M               | Done        | Critical for security. Start with CWD restriction within project. CWD sandboxing (absolute base CWD, path resolution, `startsWith` check) and command logging confirmed (meta-plan 'feat/fullstack-agent-roadmap-and-initial-tools').                                                                                                                                                                                                |
| T004    | Tools-P1          | TerminalTool                | Create `getTerminalToolDefinitions` function                         | - In `terminal.tool.ts`, create `getTerminalToolDefinitions(instance: TerminalTool): IAgentTool[]`. <br> - Define `IAgentTool` for `terminal.executeCommand` with name, description, Zod schema, and execute call.                                                                                                        | T002                    | S               | Done        | To make it usable by `GenericAgentExecutor`. Completed during initial `TerminalTool` dev (meta-plan 'feat/fullstack-agent-roadmap-and-initial-tools').                                                                                                                          |
| T005    | Tools-P1          | TerminalTool                | Register `TerminalTool` in `main.ts`                                 | - Instantiate `TerminalTool` in `main.ts`. <br> - Call `getTerminalToolDefinitions` and register with `toolRegistry`.                                                                                                                                                                                           | T004, R001              | S               | Done        | Completed during initial `TerminalTool` dev (meta-plan 'feat/fullstack-agent-roadmap-and-initial-tools').                                                                                                                                    |
| **M001**  | Tools-P1          | **MemoryTool**              | **Define `MemoryItem` Entity & Drizzle Schema**                      | - Create `src/core/domain/entities/memory/memory-item.entity.ts` (similar to `Annotation`). <br> - Define `MemoryItemProps` and `MemoryItem` class (`id`, `content` (text), `agentId` (string), `embedding` (optional blob/array), `metadata` (optional JSON), `createdAt`, `updatedAt`). <br> - Create `memory_items` Drizzle schema in `src/infrastructure/services/drizzle/schemas/memory.ts`. |                         | M               | Done        | Completed during initial `MemoryTool` dev (meta-plan 'feat/fullstack-agent-roadmap-and-initial-tools'). User to run `db:generate` & `db:migrate`.                                                                                                                                                                       |
| M002    | Tools-P1          | MemoryTool                | Define `IMemoryRepository` Interface                                 | - Create `src/core/ports/repositories/memory.interface.ts`. <br> - Methods: `save(item: MemoryItem)`, `findById(id: string)`, `findByAgentId(agentId: string, limit?: number)`, `searchSimilar(agentId: string, queryEmbedding: number[], limit?: number)` (for future). | M001                    | S               | Done        | Interface created and updated with `findById`, `save`, `delete`, `search` (keyword-based), `findByAgentId`, and placeholder for `searchSimilar` (meta-plan 'feat/fullstack-agent-roadmap-and-initial-tools').                                                                                                                                    |
| M003    | Tools-P1          | MemoryTool                | Implement `DrizzleMemoryRepository` (basic CRUD)                     | - Create `src/infrastructure/repositories/drizzle/memory.repository.ts`. <br> - Implement `save`, `findById`, `findByAgentId`. <br> - `searchSimilar` can be a placeholder initially.                                                                                                                            | M001, M002              | M               | Done        | Completed during initial `MemoryTool` dev (meta-plan 'feat/fullstack-agent-roadmap-and-initial-tools'). Implemented `findById`, `save` (upsert), `delete`, basic keyword `search`, and `findByAgentId`.                                                                                                                                                                               |
| M004    | Tools-P1          | MemoryTool                | Define `IMemoryTool` UseCases (Save, Retrieve)                       | - Create `src/core/application/use-cases/memory/`. <br> - `SaveMemoryItemUseCase(text: string, agentId: string, metadata?: any)`. <br> - `RetrieveMemoryItemsUseCase(agentId: string, query?: string, limit?: number)` (simple keyword search for now if no embeddings). | M002                    | M               | Done        | Completed (Save, Search, Remove UseCases verified).                                                                                                                                    |
| M005    | Tools-P1          | MemoryTool                | Implement `MemoryTool` (`IMemoryTool` methods)                       | - Create `src/infrastructure/tools/memory.tool.ts`. <br> - `MemoryTool` class with `saveItem` and `retrieveItems` methods. <br> - Define Zod schemas for params. <br> - `saveItem` calls `SaveMemoryItemUseCase`. <br> - `retrieveItems` calls `RetrieveMemoryItemsUseCase`. | M004                    | M               | Done        | Implemented with UseCases. `agentId` integration for `MemoryItem` completed. `executionContext` used to pass `agentId` to tool method.                                                                                                                                    |
| M006    | Tools-P1          | MemoryTool                | Create `getMemoryToolDefinitions` & Register                         | - In `memory.tool.ts`, create `getMemoryToolDefinitions(instance: MemoryTool): IAgentTool[]`. <br> - Define `IAgentTool`s for `memory.saveItem`, `memory.retrieveItems`. <br> - Instantiate and register in `main.ts`.                                                              | M005, R001              | S               | Done        | Tool definitions created, `MemoryTool` registered in `main.ts`, and persona configs updated.                                                                                                                                    |
| **R001**  | Core-P1           | **Tool Registration**       | **Centralize Tool Instantiation in `main.ts`**                       | - Review `main.ts` to ensure all tools (`FileSystemTool`, `AnnotationTool`, `TaskTool`, `TerminalTool`, `MemoryTool`) are instantiated with their dependencies (UseCases -> Repositories -> DB) and registered with `toolRegistry`. | T005, M006              | M               | Done        | Reviewed and confirmed: `main.ts` correctly and consistently instantiates and registers all five core tools (FileSystem, Annotation, Task, Terminal, Memory) with their dependencies and the `ToolRegistry`.                                                                                                                                                                                           |
| **A001**  | Core-P1           | **GenericAgentExecutor**    | **Enhance `processJob` for Robustness**                              | - Review error handling from tool calls. <br> - Ensure `agentState.executionHistory` captures errors correctly. <br> - Refine logic for when to retry vs. fail based on tool errors (currently LLM decides based on prompt).                                                                   |                         | M               | Done        | Reviewed tool error handling in `GenericAgentExecutor`. `executionHistory` now uses a standardized `ExecutionHistoryEntry` format. Confirmed that the iterative LLM approach (surfacing tool errors to LLM via `conversationHistory` for re-planning, guided by system prompt) is the chosen strategy for retry/fail logic.                                                                                                                                                                                  |
| A002    | Core-P1           | GenericAgentExecutor    | Context Summarization Strategy (Initial Research)                    | - Research techniques for summarizing `conversationHistory` for long-running tasks to manage token limits. <br> - Options: simple truncation, LLM-based summarization of early turns, embedding-based context retrieval.                                                     |                         | M               | Done        | Research completed. Strategies documented in `docs/context-summarization-strategies.md`. Initial recommendation: Implement LLM-based summarization of oldest turns first, then RAG via MemoryTool.                                                                                                                                                                                                            |
| A003    | Core-P1           | WorkerService             | True stateful re-queuing for `CONTINUE_PROCESSING`                   | - Modify `WorkerService.processJob` when `executorResult.status === 'CONTINUE_PROCESSING'`. <br> - Ensure `job.data` (containing `agentState` with `conversationHistory`) is saved by `jobRepository.save(job)`. <br> - Job should then naturally be picked up by `poll` if still pending. |                         | M               | Done        | Verified: `GenericAgentExecutor` updates `job.data.agentState`. `WorkerService` correctly persists this state via `jobRepository.save(job)` and resets job to `WAITING` on `CONTINUE_PROCESSING` status. Current mechanism deemed robust. Context length management for very long histories is a separate task (A002 research done, implementation pending).                                                                                                                                              |
| **---** | **Phase 2: Advanced Agent Capabilities & Tools** | **---**                     | **---**                                                              | **---**                                                                                                                                                                                                                                                                                         | **---**                 | **---**         | **---**     | **---**                                                                                                                                                                                                                                                            |
| P001    | Personas-P2       | AgentPersonaTemplate        | Create `FullstackDeveloper_v1` Persona JSON                          | - Create `config/personas/fullstack_developer_v1.json` with appropriate role, goal, backstory, and `toolNames` (including new `TerminalTool`, `MemoryTool`).                                                                                                            | T005, M006              | S               | Done        | `config/personas/fullstack_developer_v1.json` created with relevant toolset (including new Terminal and Memory tools).                                                                                                                                    |
| T006    | Tools-P2          | TerminalTool                | Implement `getTerminalToolDefinitions` for all methods (if more needed) | - If `TerminalTool` needs more methods (e.g., `runScript`, `checkProcessStatus`), define them in `ITerminalTool`, implement, add Zod schemas, and add to `getTerminalToolDefinitions`.                                                                                             | T004                    | M               | Done        | No new methods for `TerminalTool` were requested at this time. `getTerminalToolDefinitions` correctly exposes the existing `executeCommand`. Considered complete for current scope.                                                                                             |
| M007    | Tools-P2          | MemoryTool                | Implement Semantic Search for `retrieveItems`                          | All sub-tasks completed: `EmbeddingService` created; `MemoryItem` schema updated for BLOB embeddings; `sqlite-vec` VSS table setup via custom migration (user applies); `DrizzleMemoryRepository.save` updated to generate embeddings & sync VSS; `DrizzleMemoryRepository.searchSimilar` implemented; `SearchSimilarMemoryItemsUseCase` created; `MemoryTool.searchMemories` refactored for semantic search; relevant persona configs and demo script updated; architecture documentation updated. | M005                    | L               | Done        | M007 Fully Completed: Semantic search for MemoryTool is now implemented using `ai-sdk.embed` (via `EmbeddingService`) and `sqlite-vec` for vector storage/search in SQLite. Includes VSS table setup (via user-applied custom Drizzle migration using SQL from `docs/manual-migrations/`), updated repository save/search logic, new semantic search UseCase, updated `MemoryTool`, persona configs, demo script, and main architecture documentation. User handles `sqlite-vec` binary placement and initial DB migrations. |
| C001    | Tools-P2 | CodeExecutionTool / javascript.executeSandboxedCode | Implement \`javascript.executeSandboxedCode\` tool using \`safeJSExecute\` utility | - Integrate \`safeJSExecute\` utility (from \`docs/utils/safe-js-execute-overview.md\`) into \`src/infrastructure/utils/safe-js-execute.ts\`. Ensure it's self-contained or dependencies are minimal and appropriate for an infrastructure utility. <br> - Define Zod schemas for params (code string, options like timeout/allowedGlobals) and result type for this tool, likely in \`src/core/ports/tools/javascript-execution.interface.ts\` or directly in the tool file. <br> - Create \`src/infrastructure/tools/javascript.tool.ts\` implementing \`IAgentTool\` for \`javascript.executeSandboxedCode\`. This tool will instantiate and use the \`safeJSExecute\` utility. <br> - Add \`getJavascriptToolDefinitions\` function in \`javascript.tool.ts\`. <br> - Register the new tool with \`ToolRegistry\` in \`main.ts\`. <br> - Update relevant \`AgentPersonaTemplate\`s (e.g., FullstackDeveloper, GenericTaskProcessor) to include \`javascript.executeSandboxedCode\` in their \`toolNames\`. <br> - Enhance system prompt in \`GenericAgentExecutor\` to guide LLM on when to use this sandboxed execution versus writing a script to file and using \`terminal.executeCommand\`. | R001         | L               | Not Started | Provides a safer way to run simple, LLM-generated JS snippets without Node module access. Based on user-provided \`safeJSExecute\` code. Requires careful testing of sandbox effectiveness. |
| A004    | Core-P2           | GenericAgentExecutor    | Implement Context Summarization (Chosen Strategy)                      | - Based on research from A002, implement a context summarization method. <br> - Integrate into `processJob` before calling LLM if history is too long.                                                                                                                                | A002                    | L               | Done        | Implemented LLM-based summarization of oldest turns in `GenericAgentExecutor` (via `_summarizeOldestMessages` method) when history exceeds `MAX_HISTORY_MESSAGES_BEFORE_SUMMARY`. Preserves initial prompts, summarizes a chunk of older messages. Documented in `context-summarization-strategies.md` and `autonomous-agent-architecture.md`.                                                                                                                                    |
| A005    | Core-P2           | GenericAgentExecutor    | LLM-based Re-planning on Significant Errors                          | - Enhance system prompt to guide LLM to explicitly state "REPLAN" if a new plan is needed. <br> - If `generateObject` returns a re-plan signal, clear `agentState.currentPlan` and `completedSteps` to trigger new planning.                                            | A001                    | M               | Done        | Implemented LLM-signaled re-planning. `GenericAgentExecutor` system prompt and output Zod schema updated for `requestReplan` flag. If true, agent summarizes failed attempt (via LLM), clears `conversationHistory`, stores summary in `job.data.lastFailureSummary` to inform new planning cycle. Documented in `autonomous-agent-architecture.md`.                                                                                                                                    |
| **---** | **Phase 3: Fullstack Task Execution & Specialization** | **---**                     | **---**                                                              | **---**                                                                                                                                                                                                                                                                                         | **---**                 | **---**         | **---**     | **---**                                                                                                                                                                                                                                                            |
| FS001   | Fullstack-P3      | Code Generation             | Basic Code Generation (Node.js script)                               | - `FullstackDeveloper_v1` persona takes a goal like 'Write a Node.js script to create and read a JSON file, then print a value'. <br> - LLM uses `fileSystem.writeFile` to save the generated `app.js` (which itself might create other files like `data.json`). <br> - Use `terminal.executeCommand` to run `node app.js` and get output. | P001, A004, A005        | L               | Done        | Successfully demonstrated basic Node.js code generation. `fullstack-agent-demo.ts` updated with a relevant task. System prompt in `GenericAgentExecutor` enhanced for coding task guidance. Agent generated, saved, and ran a Node.js script. Outcome verifiable via demo logs and `executionHistory`. |
| FS002   | Fullstack-P3      | Requirement Comprehension   | LLM Asks Clarifying Questions                                        | - Enhance system prompt in \`GenericAgentExecutor\` to guide question generation. (Done) <br> - Update LLM output Zod schema in \`GenericAgentExecutor\` for \`clarifyingQuestions\`. (Done) <br> - Implement logic in \`GenericAgentExecutor.processJob\` to save questions via \`AnnotationTool\` and return appropriate status. (Done - includes corrective work for AnnotationTool injection) <br> - Update demo script (\`fullstack-agent-demo.ts\`) with an ambiguous task to test question-asking. (Done) <br> - Update \`autonomous-agent-architecture.md\` with details of this feature. (Done) | FS001                   | M               | Done        | FS002 Fully Completed: Agent can now identify ambiguous goals and ask clarifying questions. \`GenericAgentExecutor\` prompt, Zod schema, and processing logic updated. Questions are saved as annotations. Demo script tests this. Architecture docs updated. |
| FS003   | Fullstack-P3      | Build/Test Automation       | Run Project Build & Tests via `TerminalTool`                         | - Goal: "Clone repo X, run build, then run tests." <br> - LLM uses `terminal.executeCommand` for `git clone`, `npm install`, `npm run build`, `npm test`. <br> - `fileSystem` tools to navigate. <br> - `annotation.save` to report results.                                               | FS001                   | L               | Not Started | Requires robust `TerminalTool` and good error parsing from LLM.                                                                                                                                                                                                  |
| FS004   | Fullstack-P3      | Debugging                   | Basic Debugging based on Test Output                                 | - Goal: "Tests failed for feature X. Fix them." <br> - LLM reads test output (via `terminal.executeCommand` or `fileSystem.readFile`), reads relevant code (`fileSystem.readFile`), proposes changes, writes changes (`fileSystem.writeFile`), re-runs tests. | FS003                   | L               | Not Started | Highly iterative and complex.                                                                                                                                                                                                                                      |
| ---     | **Phase R: Code Quality & Refactoring** | ---                         | ---                                                          | ---                                                                                                                                                                                                                                                                                                                                                                                       | ---                     | ---             | ---         | ---                                                                                                                                                              |
| RCF001  | Refactor-P1 | Cross-Cutting / Code Quality | Detailed Code Review and Refactoring based on Quality Guide          | - Implement refactoring tasks as detailed in \`docs/detailed-refactoring-roadmap.md\`.                                                                                                                                                                                                         | \`docs/code-quality-and-refactoring-guide.md\` creation (implicitly done) | XL              | Not Started | Specific refactoring items and their breakdown are now documented in \`docs/detailed-refactoring-roadmap.md\`. This task RCF001 will track the overall progress of that detailed plan. The \`docs/code-quality-and-refactoring-guide.md\` provides the standards for this effort. |

## 8. Phased Implementation Approach

The implementation will proceed in phases:

*   **Phase 0 (Setup - Mostly Done):** Establish the core project structure, CI/CD, and basic architectural patterns.
*   **Phase 1 (Foundational Tools & Core Agent Logic):**
    *   Implement and thoroughly test `TerminalTool` and `MemoryTool` (initially with basic CRUD, semantic search later).
    *   Ensure all tools are correctly registered and usable by `GenericAgentExecutor` via `ToolRegistry`.
    *   Solidify the `GenericAgentExecutor`'s iterative processing loop, state management in `job.data.agentState`, and error handling from tool calls.
    *   Refine the `WorkerService` to robustly handle the `CONTINUE_PROCESSING` state, ensuring jobs are correctly saved and re-queued.
    *   Begin research into context summarization for long conversations.
*   **Phase 2 (Advanced Agent Capabilities & Tools):**
    *   Implement a chosen context summarization strategy for `GenericAgentExecutor`.
    *   Enhance the LLM's ability to re-plan based on significant errors or changed circumstances.
    *   Develop more advanced features for `MemoryTool`, such as semantic search using embeddings.
    *   Define more specialized personas (like the `FullstackDeveloper_v1`) and curate their toolsets.
*   **Phase 3 (Fullstack Task Execution & Specialization):**
    *   Focus on end-to-end tasks that simulate fullstack development workflows (e.g., requirement to simple code generation, build/test automation).
    *   Start implementing more complex capabilities like basic debugging.
    *   Integrate `ProjectTool` and `MessageTool` for richer interaction with project context and users (if applicable).
*   **Ongoing:** Documentation, testing, refactoring, and performance optimization will be continuous throughout all phases.

This phased approach allows for incremental development and testing, building complexity gradually while ensuring the stability of core components.
